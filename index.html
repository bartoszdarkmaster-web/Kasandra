<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>Kassandra</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#0b0f14">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">

  <!-- Leaflet (mapa) -->
  <link rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js">
  </script>

  <!-- Chart.js (wykresy) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --bg:#0b0f14;
      --panel:#121826;
      --accent:#00ffcc;
      --danger:#ff3b3b;
      --warn:#ffaa00;
      --text:#e6edf3;
      --muted:#8b949e;
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:var(--bg);
      color:var(--text);
    }

    header{
      padding:14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-bottom:1px solid #1f2636;
    }

    h1{
      font-size:16px;
      margin:0;
      letter-spacing:.5px;
    }

    button{
      background:var(--accent);
      border:none;
      padding:6px 12px;
      border-radius:6px;
      font-weight:700;
      cursor:pointer;
    }

    main{
      padding:14px;
      display:grid;
      gap:14px;
    }

    .grid{
      display:grid;
      gap:14px;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    }

    .card{
      background:var(--panel);
      border:1px solid #1f2636;
      border-radius:10px;
      padding:12px;
    }

    .card h2{
      font-size:13px;
      color:var(--muted);
      margin:0 0 6px;
    }

    .value{
      font-size:26px;
      font-weight:800;
    }

    .small{
      font-size:11px;
      color:var(--muted);
    }

    .danger{color:var(--danger)}
    .warn{color:var(--warn)}
    .accent{color:var(--accent)}

    footer{
      text-align:center;
      padding:10px;
      font-size:11px;
      color:var(--muted);
    }

    .lang{
      cursor:pointer;
      margin-left:6px;
      font-size:18px;
    }
  </style>
</head>

<body>

<header>
  <h1 id="title">KASSANDRA Â· Strategic Early Warning</h1>
  <div>
    <span class="lang" onclick="setLang('pl')">ðŸ‡µðŸ‡±</span>
    <span class="lang" onclick="setLang('en')">ðŸ‡¬ðŸ‡§</span>
    <button onclick="updateData()">UPDATE</button>
  </div>
</header>

<main>

  <!-- STATUS GLOBALNY -->
  <section class="grid">
    <div class="card">
      <h2 id="t_threat">Global Threat Level</h2>
      <div class="value danger" id="threat">HIGH</div>
    </div>

    <div class="card">
      <h2 id="t_conf">Confidence</h2>
      <div class="value accent" id="confidence">0.74</div>
    </div>

    <div class="card">
      <h2 id="t_time">Last update</h2>
      <div class="value" id="time">â€”</div>
    </div>
  </section>

  <!-- MAPA OPERACYJNA -->
  <section class="card">
    <h2 id="t_map">Operational Map</h2>
    <div id="map" style="height:300px;border-radius:8px;"></div>
    <div class="small">
      Troops Â· Logistics Â· Hospitals Â· Ammo
    </div>
  </section>

  <!-- WYKRES -->
  <section class="card">
    <h2 id="t_chart">Escalation Trend</h2>
    <canvas id="chart"></canvas>
  </section>

  <!-- WYJAÅšNIENIE -->
  <section class="card">
    <h2 id="t_explain">Why HIGH?</h2>
    <ul class="small">
      <li>Troop movements â†‘ (0.30)</li>
      <li>Fuel & logistics â†‘ (0.20)</li>
      <li>Hospital expansion â†‘ (0.15)</li>
      <li>Ammo storage â†‘ (0.15)</li>
      <li>Information warfare â†‘ (0.10)</li>
      <li>Political signaling â†‘ (0.10)</li>
    </ul>
  </section>

</main>

<footer>
  Kassandra Â· internal analytical system Â· build v1
</footer>

<script>
/* ===== JÄ˜ZYKI ===== */
const dict={
  pl:{
    title:"KASSANDRA Â· System Wczesnego Ostrzegania",
    threat:"Poziom zagroÅ¼enia",
    conf:"PewnoÅ›Ä‡ danych",
    time:"Ostatnia aktualizacja",
    map:"Mapa operacyjna",
    chart:"Trend eskalacji",
    explain:"Dlaczego HIGH?"
  },
  en:{
    title:"KASSANDRA Â· Strategic Early Warning",
    threat:"Global Threat Level",
    conf:"Confidence",
    time:"Last update",
    map:"Operational Map",
    chart:"Escalation Trend",
    explain:"Why HIGH?"
  }
};

function setLang(l){
  document.getElementById("title").innerText=dict[l].title;
  document.getElementById("t_threat").innerText=dict[l].threat;
  document.getElementById("t_conf").innerText=dict[l].conf;
  document.getElementById("t_time").innerText=dict[l].time;
  document.getElementById("t_map").innerText=dict[l].map;
  document.getElementById("t_chart").innerText=dict[l].chart;
  document.getElementById("t_explain").innerText=dict[l].explain;
}

/* ===== UPDATE ===== */
function updateData(){
  document.getElementById("confidence").innerText =
    (0.65 + Math.random()*0.25).toFixed(2);
  document.getElementById("time").innerText =
    new Date().toISOString().slice(11,19);
}
updateData();

/* ===== MAPA ===== */
const map=L.map("map").setView([50.5,30.5],6);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
  {maxZoom:18}).addTo(map);

[
  {c:[52.2,21.0],t:"Troops",col:"#ff3b3b"},
  {c:[50.3,23.0],t:"Fuel depot",col:"#ffaa00"},
  {c:[49.8,24.0],t:"Hospital",col:"#ffaa00"},
  {c:[53.0,27.5],t:"Ammo storage",col:"#ff3b3b"}
].forEach(p=>{
  L.circleMarker(p.c,{
    radius:8,
    color:p.col,
    fillOpacity:.8
  }).addTo(map).bindPopup(p.t);
});

/* ===== WYKRES ===== */
new Chart(document.getElementById("chart"),{
  type:"line",
  data:{
    labels:["-7","-6","-5","-4","-3","-2","-1","Now"],
    datasets:[{
      data:[0.42,0.45,0.5,0.56,0.63,0.71,0.78,0.84],
      borderColor:"#ff3b3b",
      tension:.4
    }]
  },
  options:{
    plugins:{legend:{display:false}},
    scales:{y:{min:0,max:1}}
  }
});

/* ===== SERVICE WORKER ===== */
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("/Kasandra/sw.js");
}
</script>

</body>
</html>
